"use strict";var express=require("express"),router=express.Router(),catchErrors=require("../lib/async-error"),_require=require("../models"),Project=_require.Project,Employee=_require.Employee,Participation=_require.Participation,PeerEvaluation=_require.PeerEvaluation,PMEvaluation=_require.PMEvaluation,CustomerEvaluation=_require.CustomerEvaluation;router.get("/peer",function(e,n){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:n.render("evaluation/peer_evaluation");case 1:case"end":return e.stop()}})}),router.get("/pm",function(e,n){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:n.render("evaluation/pm_evaluation");case 1:case"end":return e.stop()}})}),router.get("/customer",function(e,n){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:n.render("evaluation/customer_evaluation");case 1:case"end":return e.stop()}})}),router.get("/inputPm_evaluation",function(e,n){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:n.render("evaluation/inputPm_evaluation.");case 1:case"end":return e.stop()}})}),router.get("/inputCustomer_evaluation",function(e,n){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:n.render("evaluation/inputCustomer_evaluation.");case 1:case"end":return e.stop()}})}),router.get("/inquiry",function(e,n){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:n.render("management/evaluationResult_inquiry");case 1:case"end":return e.stop()}})}),router.get("/evaluate",function(e,n){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:n.render("management/registerEvaluation");case 1:case"end":return e.stop()}})}),router.get("/index",function(e,n){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:n.render("evaluation/index");case 1:case"end":return e.stop()}})}),router.get("/project_list",catchErrors(function(e,n){var r,t,a;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return r=[],e.next=3,regeneratorRuntime.awrap(Project.findAll({attributes:["project_no","project_name"]}));case 3:for(t=e.sent,a=0;a<t.length;a++)r.push([t[a].project_no,t[a].project_name]);n.send(r);case 6:case"end":return e.stop()}})})),router.get("/employee_list/:project_no",catchErrors(function(n,r){var t,a,o,u;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],e.next=3,regeneratorRuntime.awrap(Participation.findAll({where:{project_no:n.params.project_no}}));case 3:a=e.sent,o=0;case 5:if(o<a.length)return e.next=8,regeneratorRuntime.awrap(Employee.findOne({where:{emp_no:a[o].emp_no},attributes:["name"]}));e.next=13;break;case 8:u=e.sent,t.push([a[o].emp_no,u.name]);case 10:o++,e.next=5;break;case 13:r.send(t);case 14:case"end":return e.stop()}})})),router.get("/result/all",catchErrors(function(e,n){var r,t,a,o,u,s,c,i,p,l,_,m,h,v;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return r=[],e.next=3,regeneratorRuntime.awrap(Participation.findAll({}));case 3:t=e.sent,a=0;case 5:if(a<t.length)return o=[],e.next=9,regeneratorRuntime.awrap(Employee.findOne({where:{emp_no:t[a].emp_no}}));e.next=38;break;case 9:return u=e.sent,o.push(u.emp_no),o.push(u.name),e.next=14,regeneratorRuntime.awrap(Project.findOne({where:{project_no:t[a].project_no}}));case 14:return s=e.sent,o.push(s.project_name),c=0,e.next=19,regeneratorRuntime.awrap(PeerEvaluation.findAll({where:{non_evaluator_no:t[a].emp_no,project_no:t[a].project_no}}));case 19:if(i=e.sent,(p=0)!=i.length){for(l=0;l<i.length;l++)null!=i[l]&&(c+=(i[l].evaluation_score1+i[l].evaluation_score2)/2);p=Math.round(c/i.length),o.push(p+"점")}return e.next=24,regeneratorRuntime.awrap(PMEvaluation.findOne({where:{non_evaluator_no:t[a].emp_no,project_no:t[a].project_no}}));case 24:return _=e.sent,m=0,null!=_&&(m=(_.evaluation_score1+_.evaluation_score2)/2,o.push(m+"점")),e.next=29,regeneratorRuntime.awrap(CustomerEvaluation.findOne({where:{non_evaluator_no:t[a].emp_no,project_no:t[a].project_no}}));case 29:h=e.sent,v=0,null!=h&&(v=(h.evaluation_score1+h.evaluation_score2)/2,o.push(v+"점")),o.push(Math.round(p+m+v)+"점"),o.push(Math.round((p+m+v)/3)+"점"),8==o.length&&r.push(o);case 35:a++,e.next=5;break;case 38:n.send(r);case 39:case"end":return e.stop()}})})),router.get("/result/empName",catchErrors(function(e,n){var r,t,a,o,u,s,c,i,p,l,_,m,h,v;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return r=[],e.next=3,regeneratorRuntime.awrap(Participation.findAll({}));case 3:t=e.sent,a=0;case 5:if(a<t.length)return o=[],e.next=9,regeneratorRuntime.awrap(Employee.findOne({where:{emp_no:t[a].emp_no}}));e.next=37;break;case 9:return u=e.sent,o.push(u.name),e.next=13,regeneratorRuntime.awrap(Project.findOne({where:{project_no:t[a].project_no}}));case 13:return s=e.sent,o.push(s.project_name),c=0,e.next=18,regeneratorRuntime.awrap(PeerEvaluation.findAll({where:{non_evaluator_no:t[a].emp_no,project_no:t[a].project_no}}));case 18:if(i=e.sent,(p=0)!=i.length){for(l=0;l<i.length;l++)null!=i[l]&&(c+=(i[l].evaluation_score1+i[l].evaluation_score2)/2);p=Math.round(c/i.length),o.push(p)}return e.next=23,regeneratorRuntime.awrap(PMEvaluation.findOne({where:{non_evaluator_no:t[a].emp_no,project_no:t[a].project_no}}));case 23:return _=e.sent,m=0,null!=_&&(m=(_.evaluation_score1+_.evaluation_score2)/2,o.push(m)),e.next=28,regeneratorRuntime.awrap(CustomerEvaluation.findOne({where:{non_evaluator_no:t[a].emp_no,project_no:t[a].project_no}}));case 28:h=e.sent,v=0,null!=h&&(v=(h.evaluation_score1+h.evaluation_score2)/2,o.push(v)),o.push(Math.round(p+m+v)),o.push(Math.round((p+m+v)/3)),7==o.length&&r.push(o);case 34:a++,e.next=5;break;case 37:n.send(r);case 38:case"end":return e.stop()}})})),router.get("/result/empNum/:emp_no",catchErrors(function(n,r){var t,a,o,u,s,c,i,p,l,_,m,h,v,f;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],e.next=3,regeneratorRuntime.awrap(Participation.findAll({where:{emp_no:n.params.emp_no}}));case 3:a=e.sent,o=0;case 5:if(o<a.length)return u=[],e.next=9,regeneratorRuntime.awrap(Employee.findOne({where:{emp_no:a[o].emp_no}}));e.next=37;break;case 9:return s=e.sent,u.push(s.name),e.next=13,regeneratorRuntime.awrap(Project.findOne({where:{project_no:a[o].project_no}}));case 13:return c=e.sent,u.push(c.project_name),i=0,e.next=18,regeneratorRuntime.awrap(PeerEvaluation.findAll({where:{non_evaluator_no:a[o].emp_no,project_no:a[o].project_no}}));case 18:if(p=e.sent,(l=0)!=p.length){for(_=0;_<p.length;_++)null!=p[_]&&(i+=(p[_].evaluation_score1+p[_].evaluation_score2)/2);l=Math.round(i/p.length),u.push(l)}return e.next=23,regeneratorRuntime.awrap(PMEvaluation.findOne({where:{non_evaluator_no:a[o].emp_no,project_no:a[o].project_no}}));case 23:return m=e.sent,h=0,null!=m&&(h=(m.evaluation_score1+m.evaluation_score2)/2,u.push(h)),e.next=28,regeneratorRuntime.awrap(CustomerEvaluation.findOne({where:{non_evaluator_no:a[o].emp_no,project_no:a[o].project_no}}));case 28:v=e.sent,f=0,null!=v&&(f=(v.evaluation_score1+v.evaluation_score2)/2,u.push(f)),u.push(Math.round(l+h+f)),u.push(Math.round((l+h+f)/3)),7==u.length&&t.push(u);case 34:o++,e.next=5;break;case 37:r.send(t);case 38:case"end":return e.stop()}})})),router.get("/result/projectName",catchErrors(function(e,n){var r,t,a,o,u,s,c,i,p,l,_,m,h,v;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return r=[],e.next=3,regeneratorRuntime.awrap(Participation.findAll({}));case 3:t=e.sent,a=0;case 5:if(a<t.length)return o=[],e.next=9,regeneratorRuntime.awrap(Employee.findOne({where:{emp_no:t[a].emp_no}}));e.next=37;break;case 9:return u=e.sent,o.push(u.name),e.next=13,regeneratorRuntime.awrap(Project.findOne({where:{project_no:t[a].project_no}}));case 13:return s=e.sent,o.push(s.project_name),c=0,e.next=18,regeneratorRuntime.awrap(PeerEvaluation.findAll({where:{non_evaluator_no:t[a].emp_no,project_no:t[a].project_no}}));case 18:if(i=e.sent,(p=0)!=i.length){for(l=0;l<i.length;l++)null!=i[l]&&(c+=(i[l].evaluation_score1+i[l].evaluation_score2)/2);p=Math.round(c/i.length),o.push(p+"점")}return e.next=23,regeneratorRuntime.awrap(PMEvaluation.findOne({where:{non_evaluator_no:t[a].emp_no,project_no:t[a].project_no}}));case 23:return _=e.sent,m=0,null!=_&&(m=(_.evaluation_score1+_.evaluation_score2)/2,o.push(m+"점")),e.next=28,regeneratorRuntime.awrap(CustomerEvaluation.findOne({where:{non_evaluator_no:t[a].emp_no,project_no:t[a].project_no}}));case 28:h=e.sent,v=0,null!=h&&(v=(h.evaluation_score1+h.evaluation_score2)/2,o.push(v+"점")),o.push(Math.round(p+m+v)+"점"),o.push(Math.round((p+m+v)/3)+"점"),7==o.length&&r.push(o);case 34:a++,e.next=5;break;case 37:n.send(r);case 38:case"end":return e.stop()}})})),router.get("/result/:emp_no/:project_no",catchErrors(function(n){var r,t,a,o,u;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return(r=[]).push(project.project_name),e.next=4,regeneratorRuntime.awrap(PeerEvaluation.findOne({where:{project_no:n.params.project_no,non_evaluator_no:n.params.emp_no}}));case 4:return e.sent,r.push(evaluation_score1),e.next=8,regeneratorRuntime.awrap(PMEvaluation.findOne({where:{project_no:n.params.project_no,non_evaluator_no:n.params.emp_no}}));case 8:return t=e.sent,a=(t.evaluation_score1+t.evaluation_score2)/2,r.push(a),e.next=13,regeneratorRuntime.awrap(CustomerEvaluation.findOne({where:{project_no:n.params.project_no,non_evaluator_no:n.params.emp_no}}));case 13:o=e.sent,u=(o.evaluation_score1+o.evaluation_score2)/2,r.push(u);case 16:case"end":return e.stop()}})})),module.exports=router;
//# sourceMappingURL=evaluation.min.js.map
