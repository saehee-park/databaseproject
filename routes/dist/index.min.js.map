{"version":3,"sources":["index.js"],"names":["express","require","router","Router","Skill","Project","Employee","bcrypt","admin","serAccount","generateHash","password","comparePassword","hash","initializeApp","validateForm","form","name","id","length","getDday","end","today","Date","getFullYear","month","getMonth","day","getDate","dateArray","toString","split","end_date","catchErrors","cert","set","get","req","res","next","render","skills","regeneratorRuntime","async","_context","prev","awrap","findAll","sent","stop","user","pwd","education","work_experience","emp_no","userSkills","_context2","session","authorization","json","message","findOne","authorization_no","include","model","EmpSkill","where","concat","attributes","route","projects","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_iterator","_step","project","d_day","_context3","console","log","body","ID","abrupt","redirect","as","undefined","value","dataValues","flash","project_name","t0","finish","skill","post","err","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_iterator2","_step2","_context4","create","PWD","dept_no","department","Symbol","iterator","done","skill_no","state","mypage","use","title"],"mappings":"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","file":"index.min.js","sourcesContent":["var express = require(\"express\");\nvar router = express.Router();\nvar Employee = require(\"../models/employee\");\nvar Skill = require(\"../models/skill\");\nvar EmpSkill = require(\"../models/emp_skill\");\nvar Project = require('../models/project');\nconst catchErrors = require(\"../lib/async-error\");\nvar bcrypt = require(\"bcrypt\");\nconst Peer = require(\"../models/peer_evaluation\");\nconst admin = require(\"firebase-admin\");\n\nlet serAccount = require(\"../node-7fe56-firebase-adminsdk-6a08y-3ebbb95309.json\");\n\nadmin.initializeApp({\n    credential: admin.credential.cert(serAccount),\n});\n\nexpress().set(\"admin\", admin);\n\nfunction generateHash(password) {\n    return bcrypt.hash(password, 10);\n}\n\nfunction comparePassword(password, hash) {\n    return bcrypt.compare(password, hash);\n}\n\nfunction validateForm(form) {\n    var name = form.name || \"\";\n    var id = form.id || \"\";\n    var password = form.password || \"\";\n\n    if (!name) {\n        return \"이름을 입력해주세요.\";\n    }\n\n    if (name.length < 2) {\n        return \"이름은 두 글자 이상 입력해주세요.\";\n    }\n\n    if (!id) {\n        return \"ID를 입력해주세요.\";\n    }\n\n    if (!password) {\n        return \"비밀번호를 입력해주세요.\";\n    }\n\n    // if (password !== password_confirmation) {\n    //   return '비밀번호가 일치하지 않습니다.';\n    // }\n\n    if (password.length < 7) {\n        return \"비밀번호가 너무 짧습니다. (8자 이상)\";\n    }\n\n    return null;\n}\n\nfunction getDday(end) {\n    let today = new Date();\n    let year = today.getFullYear(); // 년도\n    let month = today.getMonth() + 1;  // 월\n    let day = today.getDate();  // 날짜\n\n    var endArray = end.toString().split(\" \");\n    var end_date = endArray[0];\n    var dateArray = end_date.split(\"-\");\n\n    if(year == dateArray[0]) {\n        if(month == dateArray[1]) {\n            if(dateArray[2] - day <= 7) {\n                return dateArray[2] - day;\n            }\n        }\n    }\n\n    return null;\n}\n\n/* GET index listing. */\nrouter.get(\"/\", function (req, res, next) {\n    res.render(\"index\", { title: \"Index\" });\n});\n\nrouter.get(\"/signup\", catchErrors(async (req, res, next) => {\n    const skills = await Skill.findAll();\n    res.render(\"signup\", {skills: skills});\n}));\n\nrouter.get(\"/mypage\", async (req, res) => {\n    if (!req.session.authorization) res.json({ message: \"you should login\" });\n    const user = await Employee.findOne({\n        where: { authorization_no: req.session.authorization },\n    });\n    const { id, pwd, education, name, work_experience, emp_no } = user;\n    const userSkills = await Skill.findAll({\n        include: [\n            {\n                model: EmpSkill,\n                where: [`emp_no = ${emp_no}`],\n            },\n        ],\n        attributes: [\"skill_name\"],\n    });\n    res.json({\n        id,\n        pwd,\n        education,\n        skill: userSkills,\n        name,\n        work_experience,\n    });\n});\n\nrouter.route(\"/signin\")\n    .get((req, res) => {\n        res.render(\"signin\", {});\n    })\n\n    .post(\n        catchErrors(async (req, res, next) => {\n            console.log(req.body);\n\n            const user = await Employee.findOne({ where: { ID: req.body.id } });\n            if (!user) {\n                req.flash(\"danger\", \"존재하지 않는 ID 입니다.\");\n                return res.redirect(\"back\");\n            }\n\n            const projects = await Project.findAll({\n                where: {\n                    state: '진행중'\n                },\n                include: [\n                    {    \n                        model: Employee,\n                        as: 'project_emp',\n                        through: {\n                            where: { emp_no: user.emp_no }\n                        }\n                    }\n                ]\n            }); \n\n            for(let project of projects) {\n                var d_day = getDday(project.dataValues.end_date);\n                if(d_day) {\n                    req.flash(\"warning\", `${project.project_name} 프로젝트의 마감일자까지 ${d_day}일 남았습니다.`);\n                }\n            }\n            \n            req.session.user = user;\n            req.session.authorization = user.authorization_no;\n            req.flash(\"success\", `${user.name}님 환영합니다!`);\n            return res.redirect(\"/\");\n        })\n    );\n\nrouter.post(\"/signup\", catchErrors(async (req, res, next) => {\n    console.log(req.body);\n\n    var err = validateForm(req.body);\n    if (err) {\n        req.flash(\"danger\", err);\n        return res.redirect(\"back\");\n    }\n\n    var user = await Employee.findOne({ where: {ID: req.body.id} });\n\n    if (user) {\n        req.flash(\"danger\", \"이미 존재하는 ID 입니다.\");\n        return res.redirect(\"back\");\n    }\n\n    var password = await generateHash(req.body.password);\n\n    user = await Employee.create({\n        name: req.body.name,\n        ID: req.body.id,\n        PWD: password,\n        dept_no: req.body.department,\n        authorization_no: null,\n        education: req.body.education,\n        work_experience: null\n    });\n\n    for(let skill of req.body.skills) {\n        await EmpSkill.create({\n            emp_no: user.emp_no,\n            skill_no: skill\n        });\n    }\n\n    req.flash(\"success\", \"정상적으로 회원가입되었습니다.\");\n    res.redirect(\"/\");\n}));\n\nrouter.get(\"/signout\", (req, res, next) => {\n    delete req.session.user;\n    req.flash(\"success\", \"정상적으로 로그아웃 되었습니다.\");\n    res.redirect(\"/\");\n});\n\nrouter.get(\"/test\", function (req, res, next) {\n    res.render(\"index2\", { title: \"Express\", name: \"han sh\" });\n});\n\n// router.get(\"/project/:id\", catchErrors( async (req, res) => {\n//     const { id } = req.params;\n//     if (!req.session.authorization) res.json({ message: \"you should login\" });\n//     const user = await Employee.findOne({\n//         where: { id },\n//     });\n//     let total = 0;\n//     const scores = await Peer.findAll({\n//         where: {\n//             evaluation_no: user.emp_no,\n//         },\n//     });\n\n//     scores.forEach((val) => {\n//         total += val.evaluation_score1;\n//         total += val.evaluation_score2;\n//     });\n\n//     res.json({\n//         total,\n//         average: total / (scores.length * 2),\n//     });\n// }));\n\n// router.get(\"/project\", catchErrors( async (req, res) => {\n//     let max = -1;\n//     let index = -1;\n//     const scores = await Peer.findAll({});\n//     scores.forEach((val, i) => {\n//         const temp = val.evaluation_score1 + val.evaluation_score2;\n//         if (max < temp) index = i;\n//     });\n//     const user = await Employee.findOne({\n//         where: { emp_no: scores[index].evaluation_no },\n//     });\n\n//     res.json(user);\n// }));\n\n// mypage router 사용\nconst mypage = require(\"./mypage\");\nexpress().use(\"/mypage\", mypage);\n\n\n/*회원가입 화면*/\nrouter.get(\"/test3\", function (req, res, next) {\n    res.render(\"signup\", { title: \"Express\" });\n});\n\n/*nav_개발자*/\nrouter.get(\"/navbar\", function (req, res, next) {\n    res.render(\"includes/navbar\", { title: \"Express\" });\n});\n\n\n\n/*프로젝트 등록 페이지*/\nrouter.get(\"/addproject\", function (req, res, next) {\n    res.render(\"addProject\", { title: \"Express\" });\n});\n\n/*마이페이지*/\nrouter.get(\"/mypage\", function (req, res, next) {\n    res.render(\"mypage/mypageview\", { title: \"Express\" });\n});\n\n/*개인정보 수정*/\nrouter.get(\"/myprofileedit\", function (req, res, next) {\n    res.render(\"mypage/myProfileEdit\", { title: \"Express\" });\n});\n\n/*고객평가 해당 직원 리스트 페이지*/\nrouter.get('/evaluation/customer_evaluation', function(req, res, next){\n  res.render('evaluation/customer_evaluation', { title: 'Express' });\n});\n\n/*고객평가 입력페이지*/\nrouter.get('/evaluation/inputCustomer_evaluation', function(req, res, next){\n  res.render('evaluation/inputCustomer_evaluation', { title: 'Express' });\n});\n\n/*동료평가 해당 직원 리스트 페이지*/\nrouter.get('/evaluation/peer_evaluation', function(req, res, next){\n  res.render('evaluation/peer_evaluation', { title: 'Express' });\n});\n\n/*동료평가 입력페이지*/\nrouter.get('/evaluation/inputPeer_evaluation', function(req, res, next){\n  res.render('evaluation/inputPeer_evaluation', { title: 'Express' });\n});\n\n/*PM평가 해당 직원 리스트 페이지*/\nrouter.get('/evaluation/pm_evaluation', function(req, res, next){\n  res.render('evaluation/pm_evaluation', { title: 'Express' });\n});\n\n/*PM평가 입력페이지*/\nrouter.get('/evaluation/inputPm_evaluation', function(req, res, next){\n  res.render('evaluation/inputPm_evaluation', { title: 'Express' });\n});\n\n/*고객평가 해당 직원 리스트 페이지*/\nrouter.get('/evaluation/customer_evaluation', function(req, res, next){\n  res.render('evaluation/customer_evaluation', { title: 'Express' });\n});\n\n/*고객평가 입력페이지*/\nrouter.get('/evaluation/inputCustomer_evaluation', function(req, res, next){\n  res.render('evaluation/inputCustomer_evaluation', { title: 'Express' });\n});\n\n/*고객평가서 항목 수정페이지*/\nrouter.get('/evaluation/modification_customerEval', function(req, res, next){\n    res.render('evaluation/modification_customerEval', { title: 'Express' });\n  });\n\n/*업무능력서 항목 수정페이지*/\nrouter.get('/evaluation/modification_peerEval', function(req, res, next){\n    res.render('evaluation/modification_peerEval', { title: 'Express' });\n  });\n\n/*특정직원의 동료,pm,peer평가 결과(점수,합계,평균)를 확인하는 페이지*/\nrouter.get('/management/evaluationResult_inquiry', function(req, res, next){\n    res.render('management/evaluationResult_inquiry', { title: 'Express' });\n  });\n\n/*특정직원의 고객평가 상세결과 페이지*/\nrouter.get('/evaluation/resultCustomer_eval', function(req, res, next){\n    res.render('evaluation/resultCustomer_eval', { title: 'Express' });\n  });\n\n/*특정직원의 PM평가 상세결과 페이지*/\nrouter.get('/evaluation/resultPm_eval', function(req, res, next){\n    res.render('evaluation/resultPm_eval', { title: 'Express' });\n  });\n\n/*특정직원의 동료평가 상세결과 페이지*/\nrouter.get('/evaluation/resultPeer_eval', function(req, res, next){\n    res.render('evaluation/resultPeer_eval', { title: 'Express' });\n  });\n\n/*project index*/\nrouter.get('/project/index', function (req, res, next) {\n    res.render('project/index', { title: \"Express\" });\n});\n\n/*project create*/\nrouter.get(\"/project/new\", function (req, res, next) {\n    res.render(\"project/new\", { title: \"Express\" });\n});\n\n/*project details*/\nrouter.get(\"/project/details\", function (req, res, next) {\n    res.render(\"project/details\", { title: \"Express\" });\n});\n\n/*project modify*/\nrouter.get(\"/project/modify\", function (req, res, next) {\n    res.render(\"project/modify\", { title: \"Express\" });\n});\n\n/*project task*/\nrouter.get(\"/project/checkTask\", function (req, res, next) {\n    res.render(\"project/checkTask\", { title: \"Express\" });\n});\n\n/*add Client*/\nrouter.get(\"/addclient\", function (req, res, next) {\n    res.render(\"addclient\", { title: \"Express\" });\n});\n\n/*add Task*/\nrouter.get(\"/project/addTask\", function (req, res, next) {\n    res.render(\"project/addTask\", { title: \"Express\" });\n});\n\n/*project finish*/\nrouter.get(\"/project/finish\", function (req, res, next) {\n    res.render(\"project/finish\", { title: \"Express\" });\n});\n\n/*inquiry Employee*/\nrouter.get(\"/employee/inquiryEmployee\", function (req, res, next) {\n    res.render(\"employee/inquiryEmployee\", { title: \"Express\" });\n});\n\n/*inquiry Employee*/\nrouter.get(\"/employee/detailEmployee\", function (req, res, next) {\n    res.render(\"employee/detailEmployee\", { title: \"Express\" });\n});\n\n\n\nmodule.exports = router;\n"]}